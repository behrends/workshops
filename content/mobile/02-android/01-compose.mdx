import { Callout, Summary } from 'nextra/components'

# Einstieg in UI-Erstellung mit Compose

<Callout>
  **Dauer:** 40 Minuten 

  - Einstieg in UIs mit Jetpack Compose
  - Composables und Previews

  **Ziel:** Grundlegendes Verst√§ndnis von Compose
</Callout>

<Callout type="error" emoji="‚ÄºÔ∏è">
**Disclaimer**
Android Studio und die verschiedenen Aspekte der 
Android-Entwicklung √§ndern sich manchmal mehrmals im Jahr.
Der Dozent wird in der Vorbereitung nicht alle neuen
oder ge√§nderten Aspekte ber√ºcksichtigen k√∂nnen.

&xrarr; Es kann immer wieder passieren, dass etwas im
Live Coding nicht klappt oder hier nicht ganz korrekt ist
üòè
</Callout>

## Vorbemerkungen

Falls der vorige Termin weiter zur√ºck liegt: 

- Kurze Wiederholung und Fragen kl√§ren
- Falls n√∂tig ein neues Projekt erstellen: `TodosAndroid`
- &rarr; Projekt im Terminal mit `git` versionieren

<Callout type="warning">
Mit den Studierenden checken, wie sie auf ihrem Rechner das Projekt mit 
`git` initialisieren k√∂nnen: Terminal/git-Tools in Android Studio?
</Callout>

Zur Erinnerung: Wir wollen schrittweise eine einfache Todo-App 
erstellen, die die Grundlagen der Android-Entwicklung mit Kotlin
und Jetpack Compose vermittelt. Dabei gehen wir wie folgt vor 
(und werden auch bei den anderen Frameworks so vorgehen):

<Callout type="info">
**Vorstellung des Frameworks**

- [x] Installation und Einrichtung der Entwicklungsumgebung
- [ ] Prinzipien des Frameworks (Projektstruktur, Komponenten/Widgets, ‚Ä¶)
- [ ] App mit einem Screen: UI-Elemente, Layout, Interaktion und State
- [ ] Daten lokal speichern
- [ ] Navigation zwischen mehreren Screens

</Callout>

## `MainActivity` auf das Minimum reduzieren

Die UI-Entwicklung in Android erfolgt mit (Jetpack) Compose. 
Mit Compose steht ein modernes UI-Toolkit f√ºr die deklarative
Erstellung von Benutzeroberfl√§chen bereit. Einzelne UI-Elemente
werden als sogenannte Composable-Funktionen definiert, die meist
nur ‚ÄûComposables‚Äú genannt werden.

Wir reduzieren den Code in `MainActivity` zun√§chst auf das Minimum, 
damit wir den Code und die Prinzipien von Compose Schritt f√ºr Schritt 
kennenlernen k√∂nnen.

```kotlin
class MainActivity : ComponentActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContent {
            Text("Hello World")
        }
    }
}
```

Die weiteren Funktionen k√∂nnen gel√∂scht werden und wir zeigen, wie die Import-Anweisungen mit `Alt+Enter` aufger√§umt werden k√∂nnen.

<Callout type="important">
Wir haben ein paar ben√∂tigte oder empfohlene Code-Bestandteile wie z.B. 
`enableEdgeToEdge()` zur Einfachheit entfernt und werden diese sp√§ter 
wieder hinzuf√ºgen.
</Callout>

Bei Bedarf k√∂nnen wir die einzelnen Bestandteile besprechen:

- Eine Activity ist eine Klasse, die eine Benutzeroberfl√§che f√ºr eine App bereitstellt.
- `MainActivity` ist die _Launcher_-Activity, die beim Start der App ausgef√ºhrt und angezeigt wird, da dies so im `AndroidManifest.xml` definiert ist.
- `onCreate` ist eine Funktion, die beim Start der Activity automatisch vom Android-System ausgef√ºhrt wird (√§hnlich wie die `main`-Methode in Java-Programmen).
- `setContent` startet eine Compose-Composition f√ºr die Activity und setzt die 
√ºbergebene Composable-Lambda als Wurzel des UI-Baums.
- mit `{ ‚Ä¶ }` wird ein Lambda-Ausdruck definiert, der das UI beschreibt, d.h. `setContent` erh√§lt eine Funktion als Parameter. Diese Syntax wird _trailing lambda_ genannt und ist in Kotlin sehr verbreitet. 
- das _trailing lambda_ k√∂nnte auch so geschrieben werden: <br/> `setContent(content = { Text("Hello World") })` <br/> Die k√ºrzere Schreibweise mit `{ ‚Ä¶ }` ist aber √ºblicher und leichter lesbar (insbesondere wenn wir mehrere Composables hierarchisch verschachteln).
- `Text` ist eine vordefiniert Composable-Funktion aus der Compose-API, die einen Text darstellt.
- Wir werden weitere vordefinierte Composables kennenlernen und auch eigene Composables erstellen.

<Callout>
Der Dozent kennt nicht alle Details zu Compose und hat nur 
grundlegende Kenntnis von Kotlin. 

**Tipp:** KI-Tools wie ChatGPT oder Gemini k√∂nnen Code erkl√§ren.
</Callout>

In der Preview- bzw. Design-Ansicht ist jetzt nichts zu sehen, aber 
die App sollte bei Ausf√ºhrung im Emulator oder Handy ‚ÄûHello World‚Äú 
anzeigen.

## `Todo` als Composable-Funktion

Wir wollen eine einfache Todo-App erstellen. Dazu erstellen wir 
eine Composable-Funktion `Todo`, die einen Text anzeigt:

```kotlin
@Composable
fun Todo(text: String) {
    Text(text)
}
```

Dazu m√ºssen wir auch die entsprechenden Imports hinzuf√ºgen
(dies kann Android Studio f√ºr uns automatisch erledigen):

```kotlin
import androidx.compose.runtime.Composable
```

In `onCreate` ersetzen wir `Text` in `setContent` mit einem
Aufruf der neuen Composable-Funktion `Todo`:

```kotlin
setContent {
    Todo("Einkaufen")
}
```

## Composables mit Preview

Composable-Funktionen (oder kurz Composables) k√∂nnen auch in einer 
Vorschau angezeigt werden. Dazu erstellen wir **eine neue 
Composable-Funktion TodoPreview** und f√ºgen ihr die Annotation 
`@Preview` hinzu:

```kotlin
@Preview
@Composable
fun TodoPreview() {
    Todo("Sport machen")
}
```

Dies wird als eigene Preview-Funktion definiert, die nur in der 
Vorschau in Android Studio angezeigt wird. In der App selbst wird 
sie nicht verwendet. 

### Argumente f√ºr Previews 

Annotationen wie `@Preview` k√∂nnen auch Argumente enthalten,
die in der Vorschau verwendet werden:

```kotlin {1-3}
@Preview(showBackground = true,
    showSystemUi = true,
    name = "Todo Vorschau")
@Composable
fun TodoPreview() {
    Todo("Sport machen")
}
```

**Tipp:** Mit `Code -> Reformat Code` bzw. `Code -> Reformat File‚Ä¶` 
kann bestimmter Kotlin-Code bzw. die ganze Datei formatiert werden.

## Preview vs. Emulator

Unterschied zwischen Preview und Emulator nochmal
kurz erkl√§ren:

- Preview: Vorschau im Android Studio, zeigt das UI in der IDE
- Emulator: Simuliert ein echtes Ger√§t, zeigt das UI in einer virtuellen Umgebung

Meistens wird die App parallel zur Programmierung zum 
sofortigen Testen der √Ñnderungen im Emulator oder 
auf einem Ger√§t ausgef√ºhrt. √Ñnderungen von Composables wirken 
sich z.T. direkt live auf die App im Emulator/Ger√§t aus,
ohne dass die App neu gestartet werden muss.

`@Preview`-Composables werden gelegentlich verwendet,
wenn z.B. l√§ngere Zeit ausschlie√ülich an einem bestimmten
UI-Element bzw. Composable gearbeitet wird.

Composables mit `@Preview` sind ein n√ºtzliches Feature von Compose, 
um das UI w√§hrend der Programmierung visuell in einer Vorschau 
darzustellen. Previews sind jedoch optional und werden nicht zwingend
f√ºr die Entwicklung einer App mit Compose ben√∂tigt. Wir werden hier darauf 
meistens verzichten, da es oft einfacher ist, die App direkt im Emulator zu 
testen.

Dennoch k√∂nnte diese Funktionalit√§t mittelfristig f√ºr Teams n√ºtzlich 
sein, die Apps mit Compose entwickeln. Mehr zu Previews in Compose: https://developer.android.com/develop/ui/compose/tooling/previews

## Optional: Abh√§ngigkeiten f√ºr Compose aktualisieren

Falls Zeit ist, k√∂nnen wir noch kurz die Abh√§ngigkeiten f√ºr Compose
aktualisieren.

In `libs.versions.toml` lassen sich die Abh√§ngigkeiten f√ºr Compose
aktualisieren, damit wir die neuesten Features und Bugfixes nutzen k√∂nnen.
Versionen, die aktualisiert werden k√∂nnen, sind in der Datei gelb markiert.
Mit `Alt+Enter` k√∂nnen die neuen Versionen automatisch eingesetzt werden.

Mit der sogenannten ‚Äû_Compose-BOM_‚Äú (_Bill of Materials_) halten wir im
Android-Projekt alle Compose-Artefakte konsistent, ohne jede Lib einzeln zu 
versionieren. Wir versionieren nur die BOM; die eigentlichen Artefakte bekommen 
keine eigene Versionsangabe. 

Mehr dazu: https://developer.android.com/develop/ui/compose/bom

## Zusammenfassung zu Composables

Composable-Funktionen oder kurz _Composables_ sind Funktionen, die mit 
`@Composable` annotiert sind. Sie sind die Bausteine f√ºr die UI-Elemente 
und k√∂nnen von anderen Composables aufgerufen werden. 
Ein Composable hat keinen R√ºckgabewert und wird h√§ufig in _PascalCase_ benannt
(Namensteile werden gro√ü geschrieben). 
F√ºr bestimmte UI-Elemente wie z.B. `Text` gibt es vordefinierte Composables.
Sp√§ter werden wir auch vordefinierte Layout-Funktionen wie z.B. `Column` oder 
`Row` verwenden.

<Callout>
Composables sind ein Beispiel f√ºr die deklarative Programmierung, die in modernen 
UI-Frameworks verwendet wird. Dabei werden einzelne UI-Elemente und deren Verhalten 
als Funktionen beschrieben. Das komplette UI einer App sind verschachtelte UI-Elemente, 
die zusammen den UI-Baum bilden.

Wir werden mit Widgets in Flutter und mit Komponenten in React Native
√§hnliche Konzepte kennenlernen.

&rarr; Passende Visualisierung dazu am Whiteboard: 

- UI-Elemente farbig als geschlossene K√§sten zeichnen
- dazu passende Composable-Syntax mit `{‚Ä¶}` als Pseudocode daneben schreiben
</Callout>

## Weiterf√ºhrendes Material

Tutorial, Sample-Apps, Docs und Quick Guides zu Compose im ‚ÄûCore Area‚Äú zu UIs in 
den Android Developer Docs: https://developer.android.com/develop/ui
