import { Callout } from 'nextra/components'

# Mini-Projekt (Fortsetzung): Trinkgeldrechner mit Funktionen

<Callout>
  **Dauer:** 45-60 Minuten (Aufgaben 1-6) \
  (ggf. Besprechung beim n√§chsten Termin)

  **Ziel:** Funktionen anwenden und den Trinkgeldrechner refaktorieren
</Callout>

In diesen √úbungen wenden wir das Konzept der Funktionen an.
Dabei bauen wir auf dem Trinkgeldrechner aus der vorherigen
√úbung auf und verbessern die Struktur durch Funktionen.

<Callout type="info">
**Tipp:** Als Ausgangspunkt kann die Datei mit der Komplettl√∂sung
aus der vorherigen √úbung verwendet werden (z.B. `trinkgeld-6.js`).
Die Ausgangsdatei ist auch als Beispiell√∂sung in Moodle verf√ºgbar.
</Callout>

<Callout type="info">
**Vorgehensweise:** Erstelle eine neue Datei (z.B. `trinkgeld-funktionen.js`).
Schreibe dort zun√§chst die Funktionen mit den Testausgaben aus Aufgaben 1-5.
In Aufgabe 6 ersetzt du dann die Testausgaben durch das vollst√§ndige Hauptprogramm
mit Benutzereingaben.
</Callout>

<Callout type="warning">
Zur Festigung der bisher besprochenen Konzepte sollte noch kein
Coding-Agent eingesetzt werden. Ein KI-Chat kann bei Bedarf f√ºr
gezielte Fragen genutzt werden ‚Äî aber nicht f√ºr komplette L√∂sungen.
</Callout>

## Aufgabe 1: Einfache Funktion (Einstieg)

Schreibe eine Funktion `calculateTip`, die den Trinkgeldbetrag berechnet:

- **Parameter:** `bill` (Rechnungsbetrag), `percent` (Trinkgeld-Prozentsatz)
- **R√ºckgabewert:** Der berechnete Trinkgeldbetrag

```js
function calculateTip(bill, percent) {
  // Berechnung hier erg√§nzen
}

// Test:
let tip = calculateTip(100, 15);
console.log(tip); // Ausgabe: 15
```

## Aufgabe 2: Funktion mit Ausgabe (Einstieg)

Schreibe eine Funktion `displayResult`, die das Ergebnis formatiert ausgibt:

- **Parameter:** `bill`, `tip`, `total`
- **R√ºckgabewert:** keiner (nur Ausgabe)

```js
function displayResult(bill, tip, total) {
  // Ausgabe hier erg√§nzen
}

// Test:
displayResult(80, 12, 92);
// Erwartete Ausgabe:
// Rechnungsbetrag: 80.00
// Trinkgeld:       12.00
// Gesamtbetrag:    92.00
```

<Callout type="info">
**Tipp:** F√ºr die Formatierung auf zwei Nachkommastellen
kann `toFixed(2)` verwendet werden.
</Callout>

## Aufgabe 3: Validierungsfunktion (√úbung)

Schreibe eine Funktion `isValidInput`, die pr√ºft, ob die Eingaben g√ºltig sind:

- **Parameter:** `bill`, `percent`, `persons`
- **R√ºckgabewert:** `true` wenn g√ºltig, `false` wenn ung√ºltig

Regeln:
- `bill` muss gr√∂√üer als 0 sein
- `percent` muss zwischen 0 und 100 liegen
- `persons` muss gr√∂√üer als 0 sein

```js
function isValidInput(bill, percent, persons) {
  // Validierung hier erg√§nzen
}

// Tests:
console.log(isValidInput(50, 15, 2));   // true
console.log(isValidInput(-10, 15, 2));  // false
console.log(isValidInput(50, 150, 2));  // false
console.log(isValidInput(50, 15, 0));   // false
```

## Aufgabe 4: Bewertungsfunktion (√úbung)

Schreibe eine Funktion `getRating`, die basierend auf dem
Prozentsatz eine Bewertung zur√ºckgibt:

- **Parameter:** `percent`
- **R√ºckgabewert:** `"Sparsam"`, `"Normal"` oder `"Gro√üz√ºgig"`

Regeln:
- Unter 10%: "Sparsam"
- 10% bis unter 15%: "Normal"
- Ab 15%: "Gro√üz√ºgig"

```js
function getRating(percent) {
  // Bewertung hier erg√§nzen (mit Bedingungsoperator)
}

// Tests:
console.log(getRating(5));   // "Sparsam"
console.log(getRating(12));  // "Normal"
console.log(getRating(20));  // "Gro√üz√ºgig"
```

## Aufgabe 5: Aufteilungsfunktion (√úbung)

Schreibe eine Funktion `calculatePerPerson`, die den Betrag
pro Person berechnet:

- **Parameter:** `total`, `persons`
- **R√ºckgabewert:** Betrag pro Person

```js
function calculatePerPerson(total, persons) {
  // Berechnung hier erg√§nzen
}

// Test:
let perPerson = calculatePerPerson(120, 4);
console.log(perPerson); // Ausgabe: 30
```

## Aufgabe 6: Trinkgeldrechner refaktorieren (Vertiefung)

<Callout type="info">
**Was bedeutet ‚Äûrefaktorieren"?**

Refaktorieren (englisch: _refactoring_) bedeutet, bestehenden Code
umzustrukturieren und zu verbessern, **ohne sein Verhalten zu √§ndern**.

Das Programm macht danach also genau das Gleiche wie vorher &mdash;
aber der Code ist besser organisiert, lesbarer und einfacher zu warten.

Typische Refaktorierungen sind:
- Code in Funktionen auslagern
- Variablen besser benennen
- Doppelten Code zusammenfassen
</Callout>

Kombiniere alle Funktionen aus den vorherigen Aufgaben zu
einem vollst√§ndigen Trinkgeldrechner. Das Hauptprogramm
sollte √ºbersichtlich und gut lesbar sein.

<Callout type="info">
**Hinweis:** Die Funktion `displayResult` aus Aufgabe 2 muss f√ºr die
Komplettl√∂sung um drei Parameter erweitert werden (`perPerson`, `rating` und `percent`).
</Callout>

**Struktur:**

```js
import { questionFloat, questionInt } from 'readline-sync';

// === Funktionen ===

function calculateTip(bill, percent) {
  // ...
}

function calculatePerPerson(total, persons) {
  // ...
}

function isValidInput(bill, percent, persons) {
  // ...
}

function getRating(percent) {
  // ...
}

function displayResult(bill, tip, total, perPerson, rating, percent) {
  // ...
}

// === Hauptprogramm ===

console.log("=== Trinkgeldrechner ===");

const bill = questionFloat("Rechnungsbetrag: ");
const percent = questionFloat("Trinkgeld (%): ");
const persons = questionInt("Anzahl Personen: ");

// Berechnung und Ausgabe:
const tip = calculateTip(bill, percent);
const total = bill + tip;
const perPerson = calculatePerPerson(total, persons);
const rating = getRating(percent);

displayResult(bill, tip, total, perPerson, rating, percent);
```

<Callout type="info">
**Warum bleibt die Eingabe im Hauptprogramm?**

Eine Funktion kann nur einen Wert zur√ºckgeben. Um `bill`, `percent` und
`persons` gemeinsam zur√ºckzugeben, br√§uchten wir ein Objekt ‚Äì das lernen
wir sp√§ter. Deshalb bleibt die Eingabe vorerst im Hauptprogramm.
</Callout>

<Callout type="info">
**Hinweis zur Validierung:** Die Funktion `isValidInput` gibt
`true` oder `false` zur√ºck. Um die Berechnung bei ung√ºltigen
Eingaben zu verhindern, wird eine Verzweigung mit `if` ben√∂tigt ‚Äî
dies wird in der [n√§chsten Lektion](/prog/04-if-switch) behandelt.
</Callout>

<Callout type="info">
**Vorteile dieser Struktur:**

- Jede Funktion hat eine klar definierte Aufgabe
- Das Hauptprogramm ist kurz und √ºbersichtlich
- Funktionen k√∂nnen einzeln getestet werden
- √Ñnderungen sind einfacher (z.B. andere Bewertungsgrenzen)
</Callout>

## Zusammenfassung

<Callout emoji="üóíÔ∏è">
In diesen √úbungen haben wir gelernt:

- **Funktionen deklarieren** mit `function name(params) { ... }`
- **Parameter** f√ºr Eingabewerte verwenden
- **R√ºckgabewerte** mit `return` zur√ºckgeben
- **Code strukturieren** durch Aufteilung in kleine Funktionen
- **Wiederverwendbarkeit** durch allgemeine Funktionen erreichen
</Callout>

<Callout type="warning">
Info f√ºr Dozent: L√∂sungen siehe `trinkgeld2.js` im Repository `exercises`.
</Callout>
