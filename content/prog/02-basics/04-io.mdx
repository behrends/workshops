import { Callout } from 'nextra/components';

# Ein- und Ausgabe

<Callout>
  **Dauer:** 45 Minuten

  - Ausgaben erzeugen
  - Eingaben fÃ¼r Programme

  **Ziel:** Programme fÃ¼r Berechnungen schreiben
</Callout>

Am Anfang schreiben wir zunÃ¤chst nur kleinere Programme. Damit 
aber etwas Sinnvolles oder Interessantes berechnet werden kann, 
benÃ¶tigen wir Mechanismen, um vom Benutzer etwas zu erfragen 
(z. B. Zahlen oder Text) und die berechneten Werte auszugeben. 

## Ausgaben

Um in JavaScript etwas als Text auf dem Bildschirm auszugeben, 
verwenden wir meistens eine Hilfsmethode:

```js
console.log()
```

`console.log()` ergÃ¤nzt die Ausgabe um einen Zeilenumbruch, d.h. 
die nachfolgende Ausgabe erscheint auf der nÃ¤chsten Zeile.

Mit dieser Methode kann im Prinzip â€allesâ€œ ausgeben werden:
Text bzw. Strings, Zahlen, AusdrÃ¼cke, Variableninhalte, 
RÃ¼ckgabewerte von Funktionen, usw.

<Callout type="info">
Der Code im folgenden Beispiel kann angepasst werden und stellt die
Ausgaben mit `console.log()` automatisch unterhalb des Codes dar:
</Callout>

Manchmal ist es nÃ¼tzlich, `console.log` mit zwei Parametern zu
verwenden, um in der Ausgabe zusÃ¤tzliche Informationen zu haben:

```ts twoslash
console.log('Answer to everything:', 42);
// @log: Answer to everything: 42
```

Bemerkung: Zur console-API gibt es einen â€living standardâ€œ, der 
noch viel mehr MÃ¶glichkeiten mit console beschreibt, sodass viele 
Browser und auch Node.js diese implementieren kÃ¶nnen (siehe 
[console.spec.whatwg.org](https://console.spec.whatwg.org))

Ein Beispiel ist `console.table`, womit Arrays oder
Objekte als Tabelle angezeigt werden: 

```js
console.table([
  { city: 'Basel', temp: 7.8 },
  { city: 'Berlin', temp: 3.4 },
  { city: 'Freiburg', temp: 8.2 },
]);
```

Folgende Ausgabe wird dargestellt:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ (index) â”‚    city    â”‚  temp  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    0    â”‚  'Basel'   â”‚  7.8   â”‚
â”‚    1    â”‚  'Berlin'  â”‚  3.4   â”‚
â”‚    2    â”‚ 'Freiburg' â”‚  8.2   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


###  Ausgabe formatieren

<Callout>
In der [MDN-Dokumentation zu console.log](https://developer.mozilla.org/en-US/docs/Web/API/console#outputting_text_to_the_console) 
wird beschrieben, wie mit `%c` Styling-Anweisungen definiert werden kÃ¶nnen:

```js
console.log(
  "This is %cMy stylish message",
  "color: yellow; font-style: italic; background-color: blue;padding: 2px",
);
```

Leider wird dies von Node.js (noch?) nicht unterstÃ¼tzt (funktioniert aber im Browser).

In Node.js gibt es eine API [`util.styleText`](https://nodejs.org/api/util.html#utilstyletextformat-text-options)
mit der Ausgaben Styles erhalten kÃ¶nnen:

```js
import { styleText } from 'node:util';
const errorMessage = styleText('red', 'Error! Error!');
console.log(errorMessage);
```

Es ist auch mÃ¶glich, mehrere Styles als Array zu definieren:

```js
import { styleText } from 'node:util';
const warnMessage = styleText(['yellow','italic'], 'Warning!');
console.log(warnMessage);
```
</Callout>

Mit speziellen â€ANSI escape codesâ€œ kann die Ausgabe u.a. farbig 
gestaltet werden.

Mit `\x1b` wird eine â€Escape-Sequenzâ€œ 
eingeleitet, auf die dann nach `[` verschiedene â€Anweisungenâ€œ zur 
Formatierung folgen.

```js	
const orange = "33";	
const underline = "4";
const format = "\x1b[" + orange + ";" + underline + "m";	
console.log(format + "Hello orange underline!" + "\x1b[0m");
 
console.log("wieder ohne Formatierung");
```

Dies ist ein Ã¼berraschend mÃ¤chtiges Konzept, mit dem sich nicht 
nur optische Formatierungen von Text darstellen lassen, sondern 
das auch weitere MÃ¶glichkeiten bietet wie z. B. die Cursor-Position 
zur Ausgabe zu setzen. Dadurch werden rein textbasierte Anwendungen 
optisch aufgewertet und interessanter. 

<Callout type="info">
Diese â€ANSI escape codesâ€œ beeinflussen die Textausgabe in Anwendungen,
die in einem Terminal (Eingabeaufforderung) laufen und funktionieren 
auch in Strings mit Python.
</Callout>

Mehr zu diesen Formatierungen auf folgenden Webseiten:

Allgemeine ErlÃ¤uterung und Funktionsweise: \
[notes.burke.libbey.me/ansi-escape-codes/](https://notes.burke.libbey.me/ansi-escape-codes/)

Farbsteuerung: \
[stackoverflow.com/questions/4842424/list-of-ansi-color-escape-sequences](https://stackoverflow.com/questions/4842424/list-of-ansi-color-escape-sequences)

Liste der escape codes: \
[gist.github.com/fnky/458719343aabd01cfb17a3a4f7296797](https://gist.github.com/fnky/458719343aabd01cfb17a3a4f7296797)

Hilfsbibliothek fÃ¼r farbige Ausgabe im Terminal:
[github.com/alexeyraspopov/picocolors](https://github.com/alexeyraspopov/picocolors)

## Eingabe mit `readline-sync`

Um die Eingabe von der Tastatur einfacher zu handhaben,  installieren wir eine Hilfsbibliothek namens 
[`readline-sync`](https://github.com/anseki/readline-sync).

<Callout type="info">
**Vorbemerkung:** Die Bibliothek `readline-sync` ist ein Ã¶ffentliches Archiv auf GitHub und wird 
nicht mehr weiterentwickelt. Dennoch verwenden wir sie hier zu Beginn, da sie einfach, stabil und relativ
weit verbreitet ist. Wir nutzen sie hier, um die Eingabe von der Tastatur zu vereinfachen.

Leider ist die Dokumentation von `readline-sync` veraltet (z. B. `require` statt `import`). FÃ¼r die Verwendung von `readline-sync` 
im eigenen Code kann es hilfreich sein, KI bzw. GitHub Copilot zu
fragen &mdash; vermeiden Sie jedoch die Generierung von LÃ¶sungen!
</Callout>

Um `readline-sync` zu installieren, mÃ¼ssen wir zunÃ¤chst das Projekt initialisieren. Dazu das Terminal in VS Code Ã¶ffnen und folgenden Befehl ausfÃ¼hren:

```bash
npm init -y
```

&rarr; Hierdurch wird die Datei `package.json` erzeugt.

Dann `readline-sync` installieren:

```bash
npm install readline-sync
```

Dadurch wird `readline-sync` heruntergeladen und installiert (siehe `node_modules` und `package.json`).

In `package.json` ggf. folgenden Eintrag hinzufÃ¼gen, um
eine lÃ¤stige Warnung bei AusfÃ¼hrung des Programms zu unterbinden:

```
"type": "module",
```

<Callout type="info">
Mit `npm` (Node Package Manager) kÃ¶nnen Bibliotheken 
mit fertigem Code installiert werden. Dazu wird die
Bibliothek in einem Verzeichnis `node_modules` im
Projekt abgelegt und kann dann im eigenen Code
verwendet werden. In `package.json` wird die
Bibliothek als AbhÃ¤ngigkeit eingetragen.

JavaScript hat viele Bibliotheken, die fÃ¼r verschiedene
Zwecke in Projekten mit `npm` installiert werden kÃ¶nnen.

Jede Programmiersprache hat eine MÃ¶glichkeit,
Bibliotheken zu installieren und zu verwenden.
Hier gibt es einige Unterschiede.
</Callout>


Nun kann `readline-sync` in einem Programm verwendet werden:

```js
import { question } from 'readline-sync';

let name = question("Name eingeben: ");
```

Mit `import` kÃ¶nnen wir aus der Bibliothek oder Modulen (anderen Dateien)
Funktionen laden. In diesem Fall laden wir die Funktion `question` aus der 
Bibliothek `readline-sync`. Dazu werden wir spÃ¤ter noch mehr erfahren. Diese 
Import-Anweisung sollte am Anfang des Programms stehen.

`Name eingeben` erscheint und es kann etwas per Tastatur 
eingegeben werden.

Die AusfÃ¼hrung des Programms hÃ¤lt an, Text kann eingegeben werden 
und nach DrÃ¼cken von Enter/Return wird der Text der Variablen 
zugewiesen (im Beispiel oben `name`).

Wie kann eine Eingabe einer ganzen Zahl fÃ¼r Berechnungen erfolgen?


```js
import { questionInt } from 'readline-sync';
let num = questionInt("Bitte eine Zahl eingeben: ");
console.log(`Die eingegebene Zahl ist: ${num}`);
```

<Callout type="warning">
Wenn `questionInt` mit einem String aufgerufen wird, der nicht aus 
Ziffern besteht, dann wird eine Fehlermeldung ausgegeben und es 
wird erneut nach einer Zahl gefragt.
</Callout>

<Callout type="info" emoji="ğŸ‘¨ğŸ»â€ğŸ’»">
Wir entwickeln gemeinsam eine Wetter-App, um die besprochenen
Konzepte durch beispielhafte Verwendung zu veranschaulichen.

Es gibt bereits eine umfangreiche Version der Wetter-App 
auf GitHub unter https://github.com/behrends/weather-node. 
Wir werden in den nÃ¤chsten Terminen Schritt fÃ¼r Schritt eine Ã¤hnliche Anwendung entwickeln.

ZunÃ¤chst verwenden wir nur Variablen und Konstanten, um
einen gewÃ¼nschten Ort Ã¼ber die Tastatur einzulesen und 
eine zufÃ¤llige Temperatur fÃ¼r den Ort anzuzeigen:

```
Willkommen zur Wetter-App!
FÃ¼r welche Stadt willst du das Wetter wissen? Basel
Temperatur in Basel um 16:37:16: 2 Grad
```

Wir kÃ¶nnten die Temperatur in blauer Textfarbe anzeigen 
und den Umgang mit `Date` kurz besprechen.

**In den folgenden Lektionen wird gemeinsames Live Coding an der Wetter-App 
durch blaue Textboxen mit diesem Emoji beschrieben: ğŸ‘¨ğŸ»â€ğŸ’»**
</Callout>

## Bemerkungen

In einer [spÃ¤teren Lektion](/prog/09-misc/02-libraries) 
finden sich Infos zu weiteren nÃ¼tzlichen 
Hilfsbibliotheken.

<Callout type="warning">
Leute mit Windows-Rechnern berichten davon,
dass die Eingabe von Umlauten in `cmd.exe`
in Node.js problematisch ist.

Dies kann ggf. dadurch behoben werden, dass auf UTF-8
umgestellt wird:

```bash
chcp 65001
```
</Callout>

